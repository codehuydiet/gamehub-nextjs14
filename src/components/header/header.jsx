import style from './header.module.css'
import Link from "next/link";
import Image from "next/image";
import { getAvatar, getUser, handleLogout, isNavbarOn } from '@/lib/action';
import { auth } from '@/lib/auth';

const Header = async () => {
    const session = await auth();
    // console.log(session?.user.email);
    const data = await getUser(session?.user.email);
    // console.log(data?.isAdmin);
    return (
        <div className={style.container}>
            <div className={style.headerContainer}>
                <div className={style.toggleContainer}>
                    <form className={style.toggleNavbar} action={isNavbarOn}>
                        <button><svg className={style.toggle} viewBox="0 0 24 24" focusable="false" aria-hidden="true"><path xmlns="http://www.w3.org/2000/svg" fillRule="evenodd" clipRule="evenodd" d="M19 4C19.5523 4 20 3.55229 20 3C20 2.44772 19.5523 2 19 2L3 2C2.44772 2 2 2.44772 2 3C2 3.55228 2.44772 4 3 4L19 4ZM20.47 7.95628L15.3568 11.152C14.7301 11.5437 14.7301 12.4564 15.3568 12.848L20.47 16.0438C21.136 16.4601 22 15.9812 22 15.1958V8.80427C22 8.01884 21.136 7.54 20.47 7.95628ZM11 13C11.5523 13 12 12.5523 12 12C12 11.4477 11.5523 11 11 11L3 11C2.44771 11 2 11.4477 2 12C2 12.5523 2.44771 13 3 13L11 13ZM20 21C20 21.5523 19.5523 22 19 22L3 22C2.44771 22 2 21.5523 2 21C2 20.4477 2.44771 20 3 20L19 20C19.5523 20 20 20.4477 20 21Z"></path></svg></button>
                    </form>
                    <Link href="/" className="w-[8rem] h-[3.75rem]">
                        <svg className={style.logo} xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 -42.73504273504273 3170.940170940171 1412.4271191353216">
                            <g transform="scale(8.547008547008547) translate(10, 10)">
                                <defs></defs><g id="SvgjsG1196" transform="matrix(2.337566215647211,0,0,2.337566215647211,-0.0014513637350108079,-5)" fill="#ff847c"><g xmlns="http://www.w3.org/2000/svg"><path d="M35.33,0h-8.8c-1.98,0-3.6,1.62-3.6,3.6v32.46c-4.49,0.5-8,4.32-8,8.94v2c0,4.69,3.81,8.5,8.5,8.5   c4.35,0,7.94-3.28,8.44-7.5h1.81c-1.16,5.7-6.21,10-12.25,10c-6.89,0-12.5-5.61-12.5-12.5V33.84c1.75-0.41,3.14-1.85,3.39-3.65   l3.24-16.29c0.38-1.91,0.4-3.72,0.05-5.38C14.74,4.32,12.01,2,7.93,2S1.12,4.32,0.25,8.52C-0.1,10.19-0.08,12,0.3,13.91l3.23,16.23   c0.25,1.85,1.64,3.3,3.4,3.71V46h0.01c0.26,7.76,6.66,14,14.49,14c8,0,14.5-6.5,14.5-14.5c0-0.51-0.04-1.03-0.1-1.55   c1.74-0.25,3.1-1.74,3.1-3.55V3.6C38.93,1.62,37.31,0,35.33,0z M5.5,29.8L2.26,13.52c-0.33-1.64-0.34-3.19-0.05-4.59   C2.88,5.66,4.81,4,7.93,4s5.04,1.66,5.72,4.93c0.29,1.4,0.27,2.94-0.05,4.59l-3.25,16.35c-0.16,1.2-1.2,2.11-2.41,2.11   S5.68,31.07,5.5,29.8z M23.43,53.5c-3.58,0-6.5-2.92-6.5-6.5v-2c0-3.52,2.61-6.43,6-6.92v2.32c0,1.98,1.62,3.6,3.6,3.6h0.4v4h2.91   C29.36,51.11,26.67,53.5,23.43,53.5z M32.93,46h-4v-2h4V46z M36.93,40.4c0,0.88-0.72,1.6-1.6,1.6h-0.4h-8h-0.4   c-0.88,0-1.6-0.72-1.6-1.6V3.6c0-0.88,0.72-1.6,1.6-1.6h8.8c0.88,0,1.6,0.72,1.6,1.6V40.4z"></path><path d="M12.93,11c0-2.76-2.24-5-5-5s-5,2.24-5,5s2.24,5,5,5S12.93,13.76,12.93,11z M4.93,11c0-1.65,1.35-3,3-3s3,1.35,3,3   s-1.35,3-3,3S4.93,12.65,4.93,11z"></path><polygon points="31.93,5 29.93,5 29.93,8 26.93,8 26.93,10 29.93,10 29.93,13 31.93,13 31.93,10 34.93,10 34.93,8 31.93,8  "></polygon><path d="M30.93,16c-1.65,0-3,1.35-3,3s1.35,3,3,3c1.65,0,3-1.35,3-3S32.58,16,30.93,16z M30.93,20c-0.55,0-1-0.45-1-1s0.45-1,1-1   s1,0.45,1,1S31.48,20,30.93,20z"></path><path d="M30.93,25c-1.65,0-3,1.35-3,3s1.35,3,3,3c1.65,0,3-1.35,3-3S32.58,25,30.93,25z M30.93,29c-0.55,0-1-0.45-1-1s0.45-1,1-1   s1,0.45,1,1S31.48,29,30.93,29z"></path><path d="M30.93,34c-1.65,0-3,1.35-3,3s1.35,3,3,3c1.65,0,3-1.35,3-3S32.58,34,30.93,34z M30.93,38c-0.55,0-1-0.45-1-1s0.45-1,1-1   s1,0.45,1,1S31.48,38,30.93,38z"></path></g></g><g id="SvgjsG1197" transform="matrix(2.4619455261932255,0,0,2.4619455261932255,108.04588654020334,6.304500748860857)" fill="#ff847c"><path d="M9.9528 32.5076 l2.869 0.11195 l0.86236 7.3592 l-2.9702 -0.052892 l0.16785 -2.18 l-4.4428 2.2995 l-3.4539 -3.5758 l-1.7852 -6.376 l0.2591 -6.6948 l0.94592 -5.9888 l3.3114 -5.1404 s1.1084 -0.099648 2.203 -0.18703 l3.6417 0.60404 l0.51124 4.6312 l-2.4275 0 l-0.93668 -1.7798 l-1.2663 0.38938 c-0.105 0.032188 -2.7318 0.82628 -2.7318 0.82628 l1.6059 -0.16402 l-1.1889 4.7568 l-1.3092 6.0936 l1.6702 6.2516 l1.2502 3.2807 l1.2333 -0.6508 l3.3658 -1.7476 l-1.5092 0.0076564 z M23.677599999999998 12.190000000000001 l3.4508 27.854 l-2.4912 0 l-0.89684 -6.5524 l-0.34953 -2.9028 l-0.22535 1.0103 c-0.87384 -0.10961 -3.9498 -0.17859 -3.9498 -0.17859 l-0.26445 8.4116 l-4.0312 0.21156 l0.4032 -1.714 l2.5816 -0.44688 l-2.4421 -0.14562 l2.0136 -8.556 l6.2977 0 l-1.5652 -11.978 l-2.1102 11.271 l-2.2658 0.17859 l3.6409 -16.462 l2.2038 0 z M42.549 40.043984 l-2.4919 -0.033008 l0 -15.873 l-3.1297 8.9428 l-2.1079 0.35106 l-1.3092 -5.174 l-1.2456 -5.6208 l0.65692 5.4224 l-0.27902 11.857 l-3.0822 -0.039102 c0 -0.53348 0.4676 -27.752 0.4676 -27.752 l2.0581 0 l3.4823 15.582 l-0.18934 2.899 l3.8157 -18.481 l2.6192 0 z M48.4084 37.4202 l4.872 -0.25141 l0 2.7893 l-7.8032 0.08586 l0.20008 -11.168 l-0.71744 -16.712 l7.9916 -0.016094 l-0.21539 2.7273 l-5.6524 -0.14332 l1.6235 0.44228 l-0.93668 8.7436 l4.1048 0.25524 l0.12723 3.066 l-3.0745 0.10578 l-0.1993 -1.5591 z M71.729 12.321000000000002 l0.70596 27.722 l-2.9503 -0.065936 l-0.088164 -12.812 l0 -2.5625 l-0.3825 1.287 l-4.0228 0.010742 l0.25066 14.136 l-2.8422 -0.065936 s-0.068204 -2.298 -0.16172 -5.5672 l1.7906 -0.2591 l-1.8044 -0.23531 c-0.23226 -8.1096 -0.50436 -21.78 -0.50436 -21.78 l2.574 0.059024 l0.23609 10.462 l-1.2671 0.3227 l5.886 -0.053672 l-0.11422 -10.658 z M86.257 12.071000000000002 l0.14789 10.12 l-0.26524 8.746 l-0.7826 4.6948 l-2.7388 4.4128 l-2.8974 0 l-2.2942 -1.6196 s-2.0259 -5.9428 -2.0067 -6.2224 s-0.58024 -6.546 -0.58024 -6.546 l0.02375 -7.1592 l-0.02375 -6.4356 l2.7242 0.0023047 l0 4.6458 l0.23992 12.983 l1.3912 4.9692 l0.6684 2.7916 l-0.28746 -2.2758 l1.533 1.5092 l1.4372 -0.8148 l1.0064 -3.066 l0 -12.382 l1.9646 -0.45836 l-1.9646 0 l0 -7.8974 z M98.592 31.7372 c0.11113 0.38324 0.1557 3.4494 -0.067344 3.832 c-0.2223 0.38324 -3.7092 4.428 -3.7092 4.428 l-1.8803 0.03832 l-1.7277 0.006914 l0.3618 -3.7544 l0.25371 -2.495 l0.49212 -2.3272 l0.8424 -1.9822 l2.1869 1.3345 l0.73276 3.3136 l-1.3353 1.2333 l-0.89072 -0.23992 l1.1406 -1.0662 l-1.4748 -1.8442 l-0.7236 3.4493 l0.069764 1.3897 l0.57028 0.67836 l1.1874 -0.15945 l1.753 -1.7484 l0.81632 -3.2255 l-1.382 -2.7863 l-1.7806 -2.0758 l-1.7346 -0.40704 l-1.0018 1.7546 l-0.62084 4.7816 s-0.33879 5.998 -0.37098 5.9444 l0 0.056719 l-1.4096 0.13492 c-0.11113 -0.06746 0 -27.854 0 -27.854 l4.006 0.47832 l1.8918 1.533 l1.7806 3.7368 l-0.19621 0.87844 l-0.8792 -1.2617 s-2.0037 -2.364 -2.226 -2.4276 s-2.0773 -0.44688 -2.0773 -0.44688 l-1.0018 2.2995 l0 3.0661 l2.1516 1.405 l1.6718 -0.95816 l0.75808 -1.3376 l-1.484 -1.4372 l-1.0018 0.49516 l1.0762 1.0862 l-0.61248 0.75044 l-1.5208 -0.89756 l0.27824 -2.0083 l0.61248 -0.86236 l2.2812 1.2287 l1.8182 2.1876 l-1.8734 3.2224 l-2.226 0.86236 l2.4482 1.533 l2.0037 1.3414 s1.1781 1.8879 1.2892 2.1754 s0.62316 2.5632 0.73428 2.9465 z"></path></g>
                            </g>
                        </svg>
                    </Link>
                </div>
                <div className={style.inputContainer}>
                    <div className={style.inputWrap}>
                        <input type="text" className={style.input} placeholder="Search" />
                        <div className={style.searchContainer}>
                            <svg viewBox="0 0 24 24" focusable="false" aria-hidden="true" className={style.search}><path fillRule="evenodd" clipRule="evenodd" d="M10.5 4C6.91015 4 4 6.91015 4 10.5C4 14.0899 6.91015 17 10.5 17C14.0899 17 17 14.0899 17 10.5C17 6.91015 14.0899 4 10.5 4ZM2 10.5C2 5.80558 5.80558 2 10.5 2C15.1944 2 19 5.80558 19 10.5C19 15.1944 15.1944 19 10.5 19C5.80558 19 2 15.1944 2 10.5Z"></path><path fillRule="evenodd" clipRule="evenodd" d="M15.2929 15.2929C15.6834 14.9024 16.3166 14.9024 16.7071 15.2929L21.7071 20.2929C22.0976 20.6834 22.0976 21.3166 21.7071 21.7071C21.3166 22.0976 20.6834 22.0976 20.2929 21.7071L15.2929 16.7071C14.9024 16.3166 14.9024 15.6834 15.2929 15.2929Z"></path></svg>
                        </div>
                    </div>
                </div>
                <div className={style.authContainer}>
                    <div className={style.favoriteContainer}>
                        <svg className={style.favorite} viewBox="0 0 24 24" focusable="false" aria-hidden="true"><path fillRule="evenodd" clipRule="evenodd" d="M4.47368 6.78578C3.94666 7.79745 3.9392 9.02672 4.07146 9.70273C4.46989 11.7393 5.98381 14.0997 7.75719 15.9902C8.63197 16.9227 9.53387 17.7018 10.3315 18.2394C11.1783 18.8102 11.749 19 12 19C12.251 19 12.8217 18.8102 13.6685 18.2394C14.4661 17.7018 15.368 16.9227 16.2428 15.9902C18.0162 14.0997 19.5301 11.7393 19.9286 9.70273C20.0608 9.02672 20.0534 7.79745 19.5263 6.78578C19.2725 6.29849 18.9017 5.86627 18.3619 5.55002C17.82 5.23252 17.0529 5 15.96 5C14.7111 5 13.7204 5.56856 13.2125 6.32446C12.8891 6.80569 12.3638 6.94309 12 6.94309C11.6362 6.94309 11.1109 6.80569 10.7876 6.32446C10.2796 5.56856 9.28887 5 8.04003 5C6.94711 5 6.18001 5.23252 5.63809 5.55002C5.09831 5.86627 4.72752 6.29849 4.47368 6.78578ZM4.62707 3.82438C5.52816 3.29645 6.65797 3 8.04003 3C9.61785 3 11.0464 3.61724 12 4.64452C12.9536 3.61724 14.3822 3 15.96 3C17.342 3 18.4719 3.29645 19.3729 3.82438C20.2762 4.35357 20.8945 5.08322 21.3001 5.86176C22.0919 7.38172 22.0844 9.09982 21.8913 10.0867C21.3888 12.6555 19.5878 15.3476 17.7015 17.3585C16.7464 18.3766 15.7323 19.2603 14.7863 19.8979C13.8895 20.5023 12.8891 21 12 21C11.1109 21 10.1105 20.5023 9.21371 19.8979C8.26775 19.2603 7.25361 18.3766 6.29853 17.3585C4.41221 15.3476 2.61121 12.6555 2.10867 10.0867C1.91558 9.09982 1.90812 7.38172 2.69993 5.86176C3.1055 5.08322 3.72383 4.35357 4.62707 3.82438Z"></path></svg>
                    </div>
                    {data?.id ? (
                        <>
                            {data?.isAdmin && (
                                <div className={style.loginContainer}>
                                    <Link href='/admin' className={style.login}>admin</Link>
                                </div>
                            )}
                            <Link href='/user-nav' className={style.loginUserContainer}>
                                <Image src={await getAvatar(data.idAvatar)} alt="" fill className="rounded-[50%]"></Image>
                            </Link>
                        </>
                    ) : (
                        <div className={style.loginContainer}>
                            <Link href='/login' className={style.login}>Log in</Link>
                        </div>
                    )}
                </div>
            </div>
        </div>
    )
}
export default Header;